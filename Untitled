def login_required(f):
    @wraps(f)
    def wrap(*args,**kwargs):
        if 'logged_in' in session:
            return f(*args, **kwargs)
        else:
            flash('Please log in first!!!')
            return redirect(url_for('login'))
    return wrap


@app.route('/logout')
@login_required
def logout():
    session.pop('logged_in', None)
    flash('you\'re now logged out')
    return redirect(url_for('get_tasks'))
    
    # Route for handling the login page logic
@app.route('/login', methods=['GET', 'POST'])
def login():
    error = None
    if request.method == 'POST':
        if request.form['username'] != 'admin' or request.form['password'] != 'admin':
            error = 'Invalid Credentials. Please try again.'
        else:
            session['logged_in'] = True
            flash('you\'re logging has been successful')
            return redirect(url_for('add_recipe'))
    return render_template('login.html', error=error)
    
    
    {% block sort %}
<div class="input-field">
    <select id="sort-select">
        <option value="disabled" disabled selected>Sort recipes</option>
        <option value="desc">Cooking-time desc</option>
        <option value="asc">Cooking-time asc</option>
    s</select>
</div>
<% endblock %>



# Search results route
@app.route('/search_results', methods=["GET", "POST"])
def search_results():
    value = request.form.get('search_text')
    if request.method == 'POST':
        if len(value.split()) > 0:
            mongo.db.procedures.create_index([("$**", 'text')])
            search_results = mongo.db.procedures.find(
                {'$text': {'$search': value}})
            # for item in search_results:
            #     print("Search results: ", item)
            return render_template("tasks1.html", procedures=search_results) 
        else:
            flash("Type something")
            return redirect("tasks1.html")


    else: 
        flash("You are not allowed to perform this action")
        return redirect('/')
        
        
        
        
      ###searchhhhhhhhhhhhhhhhhhhh
      
     
<div class="row"  "center-align margin-top-3vh" "card-content">
    <div class="row hide-on-med-and-up">
        <nav class="mobile-search-bar">
            <div class="card-content">
                <form id="search-form-mobile" action="{{ url_for('search_results') }}"  value:"search" method="POST" class="col s12">
                    <div class="input-field">
                        <input class="mobile-search-bar" type="search" name="search" id="search" placeholder="Search" required>
                        <i class="material-icons" id="sendFormMobile" for="submit-form">search</i>
                    </div>
                </form>
            </div>
        </nav>
    </div>
    